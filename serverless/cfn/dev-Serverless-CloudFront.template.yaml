Resources:
  S3486F821D:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          -
            ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256
      BucketName: dev-serverless-example
      VersioningConfiguration:
        Status: Enabled
  CloudFrontOriginAccessIdentityResource:
    Type: 'AWS::CloudFront::CloudFrontOriginAccessIdentity'
    Properties:
      CloudFrontOriginAccessIdentityConfig:
        Comment: ''
  BucketPolicyResource:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket:
        Ref: S3486F821D
      PolicyDocument:
        Statement:
          -
            Action: 's3:GetObject'
            Effect: Allow
            Principal:
              AWS:
                'Fn::Join':
                  - ''
                  -
                    - >-
                      arn:aws:iam::cloudfront:user/CloudFront
                      Origin Access Identity 
                    -
                      Ref: CloudFrontOriginAccessIdentityResource
            Resource:
              'Fn::Join':
                - ''
                -
                  -
                    'Fn::GetAtt':
                      - S3486F821D
                      - Arn
                  - /*
        Version: '2012-10-17'
  DistributionResource:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
      DistributionConfig:
        DefaultCacheBehavior:
          AllowedMethods:
            - GET
            - HEAD
          ForwardedValues:
            Cookies:
              Forward: none
            QueryString: false
          TargetOriginId: S3Origin
          ViewerProtocolPolicy: https-only
        DefaultRootObject: index.html
        Enabled: true
        Origins:
          -
            DomainName:
              'Fn::GetAtt':
                - S3486F821D
                - DomainName
            Id: S3Origin
            S3OriginConfig:
              OriginAccessIdentity:
                'Fn::Join':
                  - ''
                  -
                    - origin-access-identity/cloudfront/
                    -
                      Ref: CloudFrontOriginAccessIdentityResource
    DependsOn:
      - S3486F821D
  RestApiRestApiEA0BECD9:
    Type: 'AWS::ApiGateway::RestApi'
    Properties:
      EndpointConfiguration:
        Types:
          - REGIONAL
      Name: dev-Serverless-api
  RestApiRestApiDeploymentEE9500C594da77333e50630e6262117f01980fad:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId:
        Ref: RestApiRestApiEA0BECD9
      Description: Automatically created by the RestApi construct
    DependsOn:
      - RestApiRestApitestF17F4543
      - RestApiRestApitestabcB7D79D95
      - RestApiRestApitestabcpostA4D8C436
  RestApiRestApiDeploymentStageprod53181EA1:
    Type: 'AWS::ApiGateway::Stage'
    Properties:
      RestApiId:
        Ref: RestApiRestApiEA0BECD9
      DeploymentId:
        Ref: >-
          RestApiRestApiDeploymentEE9500C594da77333e50630e6262117f01980fad
      StageName: prod
  RestApiRestApiCloudWatchRoleCAF836D0:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          -
            Action: 'sts:AssumeRole'
            Effect: Allow
            Principal:
              Service: apigateway.amazonaws.com
        Version: '2012-10-17'
      ManagedPolicyArns:
        -
          'Fn::Join':
            - ''
            -
              - 'arn:'
              -
                Ref: 'AWS::Partition'
              - >-
                :iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs
  RestApiRestApiAccount768195D1:
    Type: 'AWS::ApiGateway::Account'
    Properties:
      CloudWatchRoleArn:
        'Fn::GetAtt':
          - RestApiRestApiCloudWatchRoleCAF836D0
          - Arn
    DependsOn:
      - RestApiRestApiEA0BECD9
  RestApiRestApitestF17F4543:
    Type: 'AWS::ApiGateway::Resource'
    Properties:
      ParentId:
        'Fn::GetAtt':
          - RestApiRestApiEA0BECD9
          - RootResourceId
      PathPart: test
      RestApiId:
        Ref: RestApiRestApiEA0BECD9
  RestApiRestApitestabcB7D79D95:
    Type: 'AWS::ApiGateway::Resource'
    Properties:
      ParentId:
        Ref: RestApiRestApitestF17F4543
      PathPart: abc
      RestApiId:
        Ref: RestApiRestApiEA0BECD9
  RestApiRestApitestabcpostA4D8C436:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      HttpMethod: post
      ResourceId:
        Ref: RestApiRestApitestabcB7D79D95
      RestApiId:
        Ref: RestApiRestApiEA0BECD9
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: POST
        Type: AWS_PROXY
        Uri:
          'Fn::Join':
            - ''
            -
              - 'arn:'
              -
                Ref: 'AWS::Partition'
              - ':apigateway:'
              -
                Ref: 'AWS::Region'
              - ':lambda:path/2015-03-31/functions/'
              -
                'Fn::GetAtt':
                  - AddNewWords10BCF361
                  - Arn
              - /invocations
  AddNewWordsServiceRole47C26059:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          -
            Action: 'sts:AssumeRole'
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: '2012-10-17'
      ManagedPolicyArns:
        -
          'Fn::Join':
            - ''
            -
              - 'arn:'
              -
                Ref: 'AWS::Partition'
              - >-
                :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
  AddNewWords10BCF361:
    Type: 'AWS::Lambda::Function'
    Properties:
      Code:
        S3Bucket: deployment-projects
        S3Key: test/dummy.zip
      Handler: index.handler
      Role:
        'Fn::GetAtt':
          - AddNewWordsServiceRole47C26059
          - Arn
      Runtime: nodejs8.10
      Environment:
        Variables:
          TABLE_WORD: dev-Serverless-E
      FunctionName: dev-Serverless-E
      MemorySize: 256
      Timeout: 5
    DependsOn:
      - AddNewWordsServiceRole47C26059
  AddNewWordsApiPermissionposttestabc8EE3987A:
    Type: 'AWS::Lambda::Permission'
    Properties:
      Action: 'lambda:InvokeFunction'
      FunctionName:
        Ref: AddNewWords10BCF361
      Principal: apigateway.amazonaws.com
      SourceArn:
        'Fn::Join':
          - ''
          -
            - 'arn:'
            -
              Ref: 'AWS::Partition'
            - ':execute-api:'
            -
              Ref: 'AWS::Region'
            - ':'
            -
              Ref: 'AWS::AccountId'
            - ':'
            -
              Ref: RestApiRestApiEA0BECD9
            - /
            -
              Ref: RestApiRestApiDeploymentStageprod53181EA1
            - /post/test/abc
  AddNewWordsApiPermissionTestposttestabc499AC330:
    Type: 'AWS::Lambda::Permission'
    Properties:
      Action: 'lambda:InvokeFunction'
      FunctionName:
        Ref: AddNewWords10BCF361
      Principal: apigateway.amazonaws.com
      SourceArn:
        'Fn::Join':
          - ''
          -
            - 'arn:'
            -
              Ref: 'AWS::Partition'
            - ':execute-api:'
            -
              Ref: 'AWS::Region'
            - ':'
            -
              Ref: 'AWS::AccountId'
            - ':'
            -
              Ref: RestApiRestApiEA0BECD9
            - /test-invoke-stage/post/test/abc
  CDKMetadata:
    Type: 'AWS::CDK::Metadata'
    Properties:
      Modules: >-
        @aws-cdk/assets=0.14.1,@aws-cdk/aws-apigateway=0.14.1,@aws-cdk/aws-applicationautoscaling=0.14.1,@aws-cdk/aws-cloudfront=0.14.1,@aws-cdk/aws-cloudwatch=0.14.1,@aws-cdk/aws-codebuild=0.14.1,@aws-cdk/aws-codecommit=0.14.1,@aws-cdk/aws-codepipeline=0.14.1,@aws-cdk/aws-codepipeline-api=0.14.1,@aws-cdk/aws-cognito=0.14.1,@aws-cdk/aws-dynamodb=0.14.1,@aws-cdk/aws-ec2=0.14.1,@aws-cdk/aws-events=0.14.1,@aws-cdk/aws-iam=0.14.1,@aws-cdk/aws-kms=0.14.1,@aws-cdk/aws-lambda=0.14.1,@aws-cdk/aws-s3=0.14.1,@aws-cdk/aws-s3-notifications=0.14.1,@aws-cdk/aws-sqs=0.14.1,@aws-cdk/cdk=0.14.1,@aws-cdk/cx-api=0.14.1,cdk=0.1.0,deepmerge=2.2.1,esprima=4.0.1,js-yaml=3.12.0,json5=1.0.1,minimist=1.2.0,strip-bom=3.0.0,tsconfig-paths=3.6.0
Outputs:
  RestApiRestApiEndpointCA019919:
    Value:
      'Fn::Join':
        - ''
        -
          - 'https://'
          -
            Ref: RestApiRestApiEA0BECD9
          - .execute-api.
          -
            Ref: 'AWS::Region'
          - .amazonaws.com/
          -
            Ref: RestApiRestApiDeploymentStageprod53181EA1
          - /
    Export:
      Name: 'dev-Serverless-CloudFront:RestApiRestApiEndpointCA019919'
  cloudFrontOriginAccessIdentityId:
    Value:
      Ref: CloudFrontOriginAccessIdentityResource
    Export:
      Name: cloudFrontOriginAccessIdentityId
  cloudFrontOriginAccessIdentityS3CanonicalUserId:
    Value:
      'Fn::GetAtt':
        - CloudFrontOriginAccessIdentityResource
        - S3CanonicalUserId
    Export:
      Name: cloudFrontOriginAccessIdentityS3CanonicalUserId
